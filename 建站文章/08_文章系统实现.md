# 文章系统实现

记录文章模块的关键实现（基于实际代码）。

## 路由与权限
- 后台路由：`/admin/posts/*`（`auth` + `role:admin,editor`）
- 权限边界：admin 全量；editor 仅自己的文章

## 功能点
- 列表：`Post::with('user')->orderBy('post_id','desc')->paginate(15)`
- 新建：校验标题唯一、生成中文友好 slug、默认 draft
- 查看：基于角色校验访问权限
- 编辑/更新：标题变更时重算 slug
- 删除：按权限删除
- 发布：设置 `status='published'` 与 `published_at=now()`
- 取消发布：`status='draft'`，清空 `published_at`

## 校验规则（示例）
```php
'title' => 'required|string|max:255|unique:posts,title',
'subtitle' => 'nullable|string|max:255',
'content_markdown' => 'nullable|string',
```

## Slug 生成（中文友好）
- 替换空格/特殊字符为 `-`，保留中文、英文、数字、减号
- 清理多余减号
- 若冲突，追加自增后缀确保唯一

## 视图
- 后台：列表/新建/编辑/查看页面（AdminLTE 布局）
- 前台：`/post/{slug}` 文章详情（Clean Blog）
